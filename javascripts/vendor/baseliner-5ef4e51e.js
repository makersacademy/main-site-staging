/**
 * function to overlay a dynamically created baseline grid
 * on a webpage.
 *
 * @version 0.9.11
 * @author John Keyes <john@keyes.ie>
 * @copyright Copyright (c) 2011, John Keyes
 * @link https://github.com/jkeyes/baseline
 * @license http://jkeyes.mit-license.org/
 *
 */
function getDimension(e,t){if(e===window){var i=e.document.documentElement["client"+t],o=e.document.body;return"CSS1Compat"===e.document.compatMode&&i||o&&o["client"+t]||i}return Math.max(e.documentElement["client"+t],e.body["scroll"+t],e.documentElement["scroll"+t],e.body["offset"+t],e.documentElement["offset"+t])}var merge=function(e,t){for(prop in e)prop in t||(t[prop]=e[prop])},Baseliner=function(e){function t(e){switch(e){case"green":return[0,255,0];case"blue":return[0,0,255];case"red":return[255,0,0];case"black":return[0,0,0]}}var i={gridColor:[196,196,196],gridHeight:[10],gridOffset:0,gridOpacity:100,gridSpace:1,overlayId:"baseline-overlay"};if(null==e)e={};else{var o=parseInt(e);0==o||isNaN(o)||(e={gridHeight:o})}merge(i,e),this.opts=e;var r=this;this.overlay_id=this.opts.overlayId,this.overlay=null,this.overlay_exists=!1,this.showText=document.createTextNode("Show Baseline"),this.hideText=document.createTextNode("Hide Baseline"),this.resize=function(){this.overlay&&(height=getDimension(document,"Height"),width=getDimension(window,"Width"),this.overlay.style.width=width+"px",this.overlay.style.height=height+"px")},this.create=function(){this.overlay_exists||(this.opts.gridHeight.forEach(function(e,i){var o=e[0],r=t(e[1]);this.overlay=document.createElement("div"),this.overlay.className="overlay-element",document.body.appendChild(this.overlay),this.overlay.style.background="url(http://baselinebg.keyes.ie/?h="+o+"&r="+r[0]+"&g="+r[1]+"&b="+r[2]+"&s="+this.opts.gridSpace+") repeat",this.overlay.style.position="absolute",this.overlay.style.top=this.opts.gridOffset+"px",this.overlay.style.left="0px",this.overlay.style.zIndex=9998,this.overlay.style.opacity=this.opts.gridOpacity/100,this.resize()},this),this.overlay_exists=!0)},this.toggle=function(e){var t=document.getElementsByClassName("overlay-element");if(t.length>0){for(var i=t.length,o=0;i>o;o++)console.log(o),document.body.removeChild(t[o]);this.overlay_exists=!1}this.create()},this.refresh=function(e){var e=parseInt(e);return 1>e||isNaN(e)?(this.value=r.opts.gridHeight,r.grid_size.style.backgroundColor="red",void(r.grid_size.style.color="white")):(r.grid_size.style.backgroundColor="white",r.grid_size.style.color="black",r.overlay&&(document.body.removeChild(r.overlay),r.overlay=null),r.opts.gridHeight=e,void r.toggle(!0))},this.refreshOffset=function(e){var e=parseInt(e);return 0>e||isNaN(e)?(this.value=r.opts.gridOffset,r.grid_offset.style.backgroundColor="red",void(r.grid_offset.style.color="white")):(r.grid_offset.style.backgroundColor="white",r.grid_offset.style.color="black",r.overlay&&(document.body.removeChild(r.overlay),r.overlay=null),r.opts.gridOffset=e,void r.toggle(!0))},init=function(){switch(r.opts.gridColor){case"green":r.opts.gridColor=[0,255,0];break;case"blue":r.opts.gridColor=[0,0,255];break;case"red":r.opts.gridColor=[255,0,0];break;case"black":r.opts.gridColor=[0,0,0]}var e=document.createElement("a");e.setAttribute("href",""),e.style.color="#EEE",e.style.marginRight="12px",e.appendChild(r.showText),e.onclick=function(e){if(!e)var e=window.event;return r.toggle(),e.cancelBubble=!0,e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1},r.overlay_it=e;var t=document.createElement("label");t["for"]="baseliner_grid_size",t.innerText="Grid Size: ";var i=document.createElement("input");i.size=3,i.type="number",i.value=r.opts.gridHeight,i.style.textAlign="center",i.style.border="1px solid #CCC",i.style.padding="1px",i.style.marginRight="5px",r.grid_size=i;var o=document.createElement("label");o["for"]="baseliner_grid_size",o.innerText="Grid Offset: ";var n=document.createElement("input");n.size=3,n.type="number",n.value=r.opts.gridOffset,n.style.textAlign="center",n.style.border="1px solid #CCC",n.style.padding="1px",r.grid_offset=n;var s=document.createElement("div");s.style.position="relative",s.style.zIndex=2e4,s.style.marginTop="20px";var l=document.createElement("div");l.id="overlay-it",l.style.position="fixed",l.style.bottom="0px",l.style.left="10px",l.style.display="inline",l.style.padding="5px 15px",l.style.fontFamily="Arial, sans-serif",l.style.fontSize="12px",l.style.fontWeight="bold",l.style.textAlign="center",l.style.backgroundColor="#333",l.style.color="#EEE",l.appendChild(e),l.appendChild(t),l.appendChild(i),l.appendChild(o),l.appendChild(n),s.appendChild(l),document.body.appendChild(s);var a,d=function(){window.clearTimeout(a),a=window.setTimeout(function(){r.refresh(i.value)},400)};i.onchange=i.onkeyup=d;var c=function(){window.clearTimeout(a),a=window.setTimeout(function(){r.refreshOffset(n.value)},400)};n.onchange=n.onkeyup=c,window.onresize=function(){r.resize()},document.onkeyup=function(e){if(!e)var e=window.event;var t=e.keyCode||e.which;27==t&&(window.clearTimeout(a),a=window.setTimeout(function(){r.toggle()},400))}},init()};